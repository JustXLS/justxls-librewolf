---
 toolkit/mozapps/update/src/updater/updater.cpp |    4 +++-
 toolkit/xre/nsAppRunner.h                      |    6 +++++-
 xpcom/build/nsXPCOMPrivate.h                   |    1 +
 3 files changed, 9 insertions(+), 2 deletions(-)

Index: mozilla/toolkit/mozapps/update/src/updater/updater.cpp
===================================================================
--- mozilla.orig/toolkit/mozapps/update/src/updater/updater.cpp
+++ mozilla/toolkit/mozapps/update/src/updater/updater.cpp
@@ -113,17 +113,19 @@
 # define NULL (0)
 #endif
 
 #ifndef SSIZE_MAX
 # define SSIZE_MAX LONG_MAX
 #endif
 
 #ifndef MAXPATHLEN
-# ifdef MAX_PATH
+# ifdef PATH_MAX
+#  define MAXPATHLEN PATH_MAX
+# elif defined(_MAX_PATH)
 #  define MAXPATHLEN MAX_PATH
 # elif defined(_MAX_PATH)
 #  define MAXPATHLEN _MAX_PATH
 # elif defined(CCHMAXPATH)
 #  define MAXPATHLEN CCHMAXPATH
 # else
 #  define MAXPATHLEN 1024
 # endif
Index: mozilla/toolkit/xre/nsAppRunner.h
===================================================================
--- mozilla.orig/toolkit/xre/nsAppRunner.h
+++ mozilla/toolkit/xre/nsAppRunner.h
@@ -35,20 +35,24 @@
  *
  * ***** END LICENSE BLOCK ***** */
 
 #ifndef nsAppRunner_h__
 #define nsAppRunner_h__
 
 #ifdef XP_WIN
 #include <windows.h>
+#else
+#include <limits.h>
 #endif
 
 #ifndef MAXPATHLEN
-#ifdef _MAX_PATH
+#ifdef PATH_MAX
+#define MAXPATHLEN PATH_MAX
+#elif defined(_MAX_PATH)
 #define MAXPATHLEN _MAX_PATH
 #elif defined(CCHMAXPATH)
 #define MAXPATHLEN CCHMAXPATH
 #else
 #define MAXPATHLEN 1024
 #endif
 #endif
 
Index: mozilla/xpcom/build/nsXPCOMPrivate.h
===================================================================
--- mozilla.orig/xpcom/build/nsXPCOMPrivate.h
+++ mozilla/xpcom/build/nsXPCOMPrivate.h
@@ -226,16 +226,17 @@
 #define XPCOM_SEARCH_KEY  "ADDON_PATH"
 #define GRE_CONF_NAME "gre.config"
 #define GRE_CONF_PATH "gre.conf"
 #define GRE_CONF_DIR  "gre.d"
 #define XPCOM_DLL "libxpcom"MOZ_DLL_SUFFIX
 #define XUL_DLL   "libxul"MOZ_DLL_SUFFIX
 
 #else // Unix
+#include <limits.h> // for PATH_MAX
 
 #define XPCOM_DLL "libxpcom"MOZ_DLL_SUFFIX
 
 // you have to love apple..
 #ifdef XP_MACOSX  
 #define XPCOM_SEARCH_KEY  "DYLD_LIBRARY_PATH"
 #define GRE_FRAMEWORK_NAME "XUL.framework"
 #define XUL_DLL            "XUL"
